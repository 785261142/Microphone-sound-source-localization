说明：

到这里基本上实现了TDOA的测角的功能

首先，利用GCC-PHAT估计出各个通道之间的时延

然后，利用SRP-PHAT进行声源的定位

其中在第二步的过程中，使用到了空域收缩的方法

即使用球坐标进行搜索，逐渐缩小搜索的范围（指角度）

通过计算每个角度方向上的SRP来衡量该方向是否应该被包括进来

但是对于距离的判定缺出现了较大的误差，因此当前只能实现测角

对于距离定位，还需要对几何以及SRP的原理进行系统的分析才可以完成




同时另外一个可以进行的尝试，是先估计出时延后，直接利用几何法进行数值求解

利用空间各个点到麦克风坐标所产生的时延，与GCC-PHAT得到的时延的差

可以构建出一个代价函数，可以利用梯度法寻找这个代价函数的最小值，以及什么样的自变量可以引导其达到最小值


这种方法的难点在于，那个代价函数会很麻烦，因为有6个项进行叠加

因此对应的求导、求梯度会很麻烦，并且牛顿法涉及到了求二阶导
并且关键的是，我现在认为，对全局进行搜索，可以极小值点存在不止一个
因此当参数选择的不恰当的时候，可能搜索不到最小的那个极小值点

而且还没有考虑到噪声的问题，据说考虑到噪声的话，这种数值计算法结果会很差



总结：
因此当前的工作主要有以下几项：
	1.把当前测角的工作进行总结
	2.尝试一下数值法求解声源定位（考察噪声的影响）
	3.尝试如何利用SRP―PHAT实现精确的角度和距离的定位（这个需要从原理上进行分析了，是重点也是难点）
	4.在定位之前要不要进行预处理（如滤波），为什么滤波后时延变差了（有可能是时域滤波造成的结果）
		


关于上边的第四点，现在有了一些新的思路：
现在考虑现在有两路信号，其中2是1的延时t0，那么二者的频谱之间的联系为：幅度谱完全一致，而2的相位谱是1的相位谱的平移 phase(exp(-jwt0))，对于理想的带通滤波器而言，如（50,3400），那么会对二者的频谱进行截取，带通之外的值全为0，但是带通之内的值仍然保持着“幅度谱相等”且“相位谱线性平移”的特性，因此两路信号在滤波后的时域内仍然处于时延关系。

现在考虑的一个实际的带通滤波器，我们一般只关注它的幅度谱，而很少关心它的相位谱，这是由于在进行带通滤波的时候，我们更加关注带外的不想要的成分能否滤除干净，但是却忽略了带内的希望保留下来的成分是否收到了干扰。当实际的带通滤波器趋向于一个方波时，我们认为这是一个理想的带通滤波器，事实上我们只看到了幅度谱。

由于相位谱与信号在时域上的时延有关，因此在这里我们必须考虑相位谱。实际的带通滤波器往往无法满足零相位的形式（即对原始信号的相位完全没有影响），而且最好的情况是FIR实现线性相位，也就是说，一个时域的信号在进过滤波后本身就会发生偏移。因此在考虑到这种问题的情况下，对两路信号先经过带通滤波，再求时延的时候，本身就已经不准确了。（因为滤波器引入了它自己的时延）





因此接下来的工作就是，对于数值法的声源定位的求解。这里假设已经利用GCC-PHAT求出了4个通道的共6组的时延关系。事实上，我感觉这6组数据是冗余的，因为已知其中3个，剩下的全部已知，但是那是理想情况，现在是实测的结果，因为必须全部利用这6组数据。

首先是，代价函数的构造。最好用矩阵写，不然的话有6组，会很麻烦。
























